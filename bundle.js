!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_FPS=200,e.TIMESTEP=1e3/e.MAX_FPS,e.WIDTH=1024,e.HEIGHT=768},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(2);const i=n(7),s=n(0);class r{constructor(t){this.gameEngine=t,this.lastRender=0}setup(){this.gameLoop(0)}gameLoop(t){let e=t-this.lastRender;for(;e>=s.TIMESTEP;)this.gameEngine.update(t),e-=s.TIMESTEP;this.gameEngine.draw(),this.lastRender=t,requestAnimationFrame(t=>this.gameLoop(t))}}window.onload=()=>{new r(new i.default).setup()}},function(t,e,n){var i=n(3);"string"==typeof i&&(i=[[t.i,i,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(5)(i,s);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(4)(!1)).push([t.i,"html, body {\n    margin: 0px;\n    padding: 0px;\n    background-color: black;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    align-content: stretch;\n}\n\nh1 {\n    color: #a8a8a8;\n}\n\n#container {\n    display: flex;\n    align-items: stretch;\n    flex-direction: column;\n}\n\n#main {\n    display: flex;\n    align-items: stretch;\n}\n\ncanvas {\n    background-color: #3a3a3a;\n    margin-left: 10px;\n    margin-right: 10px;\n    -webkit-tap-highlight-color: transparent;\n}\n\n.sawtooth {\n    border-style: solid;\n    border-width: 5px;\n    border-image: url(http://i.imgur.com/Usmr9yF.png) 13 round;\n }\n\n .health {\n     width: 25px;\n     background-color: #202020;\n     display: flex;\n     align-items: flex-end;\n     justify-content: center;\n     border-radius: 10px;\n     padding-bottom: 8px;\n     padding-top: 8px;\n }\n\n .bar {\n     width: 10px;\n     border-radius: 3px;\n }\n\n #score {\n     padding-left: 9px;\n     padding-right: 9px;\n     padding-top: 5px;\n     justify-content: space-between;\n     color: white;\n     font-size: 20px;\n     display: none;\n     font-weight: bold;\n }",""])},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var s=(a=i,o=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),r=i.sources.map(function(t){return"/*# sourceURL=".concat(i.sourceRoot).concat(t," */")});return[n].concat(r).concat([s]).join("\n")}var a,o,l;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},s=0;s<this.length;s++){var r=this[s][0];null!=r&&(i[r]=!0)}for(var a=0;a<t.length;a++){var o=t[a];null!=o[0]&&i[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="(".concat(o[2],") and (").concat(n,")")),e.push(o))}},e}},function(t,e,n){var i,s,r={},a=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=i.apply(this,arguments)),s}),o=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),l=null,h=0,c=[],u=n(6);function d(t,e){for(var n=0;n<t.length;n++){var i=t[n],s=r[i.id];if(s){s.refs++;for(var a=0;a<s.parts.length;a++)s.parts[a](i.parts[a]);for(;a<i.parts.length;a++)s.parts.push(A(i.parts[a],e))}else{var o=[];for(a=0;a<i.parts.length;a++)o.push(A(i.parts[a],e));r[i.id]={id:i.id,refs:1,parts:o}}}}function p(t,e){for(var n=[],i={},s=0;s<t.length;s++){var r=t[s],a=e.base?r[0]+e.base:r[0],o={css:r[1],media:r[2],sourceMap:r[3]};i[a]?i[a].parts.push(o):n.push(i[a]={id:a,parts:[o]})}return n}function f(t,e){var n=o(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=c[c.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),c.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=o(t.insertAt.before,n);n.insertBefore(e,s)}}function y(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return v(e,t.attrs),f(t,e),e}function v(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function A(t,e){var n,i,s,r;if(e.transform&&t.css){if(!(r="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=r}if(e.singleton){var a=h++;n=l||(l=g(e)),i=L.bind(null,n,a,!1),s=L.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),f(t,e),e}(e),i=function(t,e,n){var i=n.css,s=n.sourceMap,r=void 0===e.convertToAbsoluteUrls&&s;(e.convertToAbsoluteUrls||r)&&(i=u(i));s&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var a=new Blob([i],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}.bind(null,n,e),s=function(){y(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),s=function(){y(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else s()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return d(n,e),function(t){for(var i=[],s=0;s<n.length;s++){var a=n[s];(o=r[a.id]).refs--,i.push(o)}t&&d(p(t,e),e);for(s=0;s<i.length;s++){var o;if(0===(o=i[s]).refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete r[o.id]}}}};var m,_=(m=[],function(t,e){return m[t]=e,m.filter(Boolean).join("\n")});function L(t,e,n,i){var s=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=_(e,s);else{var r=document.createTextNode(s),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var s,r=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?t:(s=0===r.indexOf("//")?r:0===r.indexOf("/")?n+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(8),s=n(0);e.default=class{constructor(){let t=document.getElementById("canvas");t.width=s.WIDTH,t.height=s.HEIGHT,this.gameState=new i.default(0,t)}changeState(t){this.gameState=t}update(t){this.gameState.update(this,t)}draw(){this.gameState.draw()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(9),s=n(0);e.default=class{constructor(t,e){this.INTRO_DURATION_MS=3e3,this.FADEOUT_START_MS=this.INTRO_DURATION_MS-1e3,this.startTime=t,this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.alpha=1}update(t,e){let n=e-this.startTime;n>this.INTRO_DURATION_MS&&t.changeState(new i.default(this.canvas)),n>this.FADEOUT_START_MS&&(this.alpha=1-(n-this.FADEOUT_START_MS)/(this.INTRO_DURATION_MS-this.FADEOUT_START_MS))}draw(){this.clearCanvas();let t="rgba(255, 255, 255, "+this.alpha+")";this.ctx.font="60px Arial",this.ctx.fillStyle=t,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText("gem.",s.WIDTH/2,s.HEIGHT/2)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(10),s=n(11),r=n(0);e.default=class{constructor(t){this.BALL_RADIUS=20,this.BALL_COLOR="#8f5454",this.OTHER_BALL_COLOR="#6c8f54",this.BALL_ACCELERATION=.008,this.BALL_BREAK_FACTOR=.95,this.HEALTH_REGAIN_RATE=.01,this.WALL_BOUNCE_PENALY=25,this.KEY_MAP=new Map([[68,i.Direction.Right],[65,i.Direction.Left],[87,i.Direction.Up],[83,i.Direction.Down],[16,i.Direction.Break]]),this.OTHER_KEY_MAP=new Map([[39,i.Direction.Right],[37,i.Direction.Left],[38,i.Direction.Up],[40,i.Direction.Down],[32,i.Direction.Break]]),this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.state=this.initState(0,0),document.addEventListener("keydown",t=>this.keydown(t),!1),document.addEventListener("keyup",t=>this.keyup(t),!1),this.playerHealthBar=document.getElementById("p1-health"),this.otherPlayerHealthBar=document.getElementById("p2-health"),this.playerHealthBar.style.backgroundColor=this.BALL_COLOR,this.playerHealthBar.style.height="100%",this.otherPlayerHealthBar.style.height="100%",this.otherPlayerHealthBar.style.backgroundColor=this.OTHER_BALL_COLOR,document.getElementById("score").style.display="flex",this.playerScore=document.getElementById("p1-score"),this.otherPlayerScore=document.getElementById("p2-score"),this.playerScore.style.color=this.BALL_COLOR,this.otherPlayerScore.style.color=this.OTHER_BALL_COLOR}update(t,e){if(this.isCollision(this.state.ball,this.state.otherBall)){let n=this.winnerBall(this.state);n==this.state.ball?this.state=this.initState(this.state.score+1,this.state.otherScore):this.state=this.initState(this.state.score,this.state.otherScore+1),t.changeState(new s.default(e,this.canvas,n.name,n.color,this))}else 0==this.state.ball.health?(this.state=this.initState(this.state.score,this.state.otherScore+1),t.changeState(new s.default(e,this.canvas,this.state.otherBall.name,this.state.otherBall.color,this))):0==this.state.otherBall.health?(this.state=this.initState(this.state.score+1,this.state.otherScore),t.changeState(new s.default(e,this.canvas,this.state.ball.name,this.state.ball.color,this))):this.state=Object.assign({},this.state,{ball:this.updateBall(this.state.ball,this.state.pressedKeys),otherBall:this.updateBall(this.state.otherBall,this.state.otherPressedKeys)})}draw(){this.clearCanvas(),this.drawScore(this.state.score,this.state.otherScore),this.drawBall(this.state.ball,this.playerHealthBar),this.drawBall(this.state.otherBall,this.otherPlayerHealthBar)}drawScore(t,e){this.playerScore.innerHTML=t.toString(),this.otherPlayerScore.innerHTML=e.toString()}drawBall(t,e){this.ctx.beginPath(),this.ctx.arc(t.posX,t.posY,this.BALL_RADIUS,0,2*Math.PI,!1),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath(),e.style.height=t.health+"%"}updateBall(t,e){let{posX:n,posY:s,velX:a,velY:o,health:l}=t;return e.get(i.Direction.Up)&&(o-=this.BALL_ACCELERATION),e.get(i.Direction.Down)&&(o+=this.BALL_ACCELERATION),e.get(i.Direction.Left)&&(a-=this.BALL_ACCELERATION),e.get(i.Direction.Right)&&(a+=this.BALL_ACCELERATION),e.get(i.Direction.Break)&&(a*=this.BALL_BREAK_FACTOR,o*=this.BALL_BREAK_FACTOR),l=Math.min(100,l+this.HEALTH_REGAIN_RATE),n=this.nextBallPos(n,a),this.isWallBounce(n,a,r.WIDTH)&&(n=this.bounceBall(n,a,a>0?r.WIDTH-this.BALL_RADIUS:this.BALL_RADIUS),a=-a,l=Math.max(0,l-this.WALL_BOUNCE_PENALY)),s=this.nextBallPos(s,o),this.isWallBounce(s,o,r.HEIGHT)&&(s=this.bounceBall(s,o,o>0?r.HEIGHT-this.BALL_RADIUS:this.BALL_RADIUS),o=-o,l=Math.max(0,l-this.WALL_BOUNCE_PENALY)),Object.assign({},t,{posX:n,posY:s,velX:a,velY:o,health:l})}bounceBall(t,e,n){return 2*n-t}isWallBounce(t,e,n){return t+this.BALL_RADIUS>=n||t-this.BALL_RADIUS<=0}isCollision(t,e){return Math.pow(t.posX-e.posX,2)+Math.pow(t.posY-e.posY,2)<Math.pow(2*this.BALL_RADIUS,2)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}nextBallPos(t,e){return t+e*r.TIMESTEP}initState(t,e){return{ball:{posX:r.WIDTH/4,posY:r.HEIGHT/2,velX:0,velY:0,color:this.BALL_COLOR,name:"Player 1",health:100},otherBall:{posX:3*r.WIDTH/4,posY:r.HEIGHT/2,velX:0,velY:0,color:this.OTHER_BALL_COLOR,name:"Player 2",health:100},pressedKeys:new Map([[i.Direction.Right,!1],[i.Direction.Left,!1],[i.Direction.Up,!1],[i.Direction.Down,!1]]),otherPressedKeys:new Map([[i.Direction.Right,!1],[i.Direction.Left,!1],[i.Direction.Up,!1],[i.Direction.Down,!1]]),lastRender:0,score:t,otherScore:e}}keydown(t){this.KEY_MAP.has(t.keyCode)&&this.state.pressedKeys.set(this.KEY_MAP.get(t.keyCode),!0),this.OTHER_KEY_MAP.has(t.keyCode)&&this.state.otherPressedKeys.set(this.OTHER_KEY_MAP.get(t.keyCode),!0)}keyup(t){this.KEY_MAP.has(t.keyCode)&&this.state.pressedKeys.set(this.KEY_MAP.get(t.keyCode),!1),this.OTHER_KEY_MAP.has(t.keyCode)&&this.state.otherPressedKeys.set(this.OTHER_KEY_MAP.get(t.keyCode),!1)}winnerBall(t){return Math.pow(t.ball.velX,2)+Math.pow(t.ball.velY,2)>Math.pow(t.otherBall.velX,2)+Math.pow(t.otherBall.velY,2)?t.ball:t.otherBall}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Up=0]="Up",t[t.Down=1]="Down",t[t.Left=2]="Left",t[t.Right=3]="Right",t[t.Break=4]="Break"}(e.Direction||(e.Direction={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(0);e.default=class{constructor(t,e,n,i,s){this.WIN_DURATION=1500,this.FADEOUT_START_MS=this.WIN_DURATION-500,this.startTime=t,this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.alpha=1,this.winnerName=n,this.winnerColor=i,this.playState=s}update(t,e){let n=e-this.startTime;n>this.WIN_DURATION&&t.changeState(this.playState),n>this.FADEOUT_START_MS&&(this.alpha=1-(n-this.FADEOUT_START_MS)/(this.WIN_DURATION-this.FADEOUT_START_MS))}draw(){this.clearCanvas();let t=this.hexToRGBA(this.winnerColor,this.alpha);this.ctx.font="80px times new roman bold",this.ctx.fillStyle=t,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(this.winnerName+" wins.",i.WIDTH/2,i.HEIGHT/2)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}hexToRGBA(t,e){return"rgba("+ +("0x"+t[1]+t[2])+", "+ +("0x"+t[3]+t[4])+", "+ +("0x"+t[5]+t[6])+","+e+")"}}}]);
//# sourceMappingURL=bundle.js.map